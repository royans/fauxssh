# Logging & Analytics

All captured data is stored in the configured `data/` directory.

## Data Structure

### 1. SQLite Database (`honeypot.sqlite`)
The core storage engine.
- `sessions`: Session metadata, IP, username, password, client version, HASSH fingerprints.
- `interactions`: Full command/response history, execution duration, LLM request hashes.
- `auth_events`: Log of every authentication attempt (password/key), success/fail status.
- `global_filesystem`: The simulated VFS state.
- `user_filesystem`: Quarantined file uploads per session. Tracks `last_accessed` for auto-cleanup.
- `command_analysis`: Threat intelligence data generated by the LLM.

### 2. JSON Logs (`honeypot.json.log`)
A structured log file ideal for ingestion into ELK/Splunk/Graylog.
```json
{
  "timestamp": 1704225600.123,
  "session_id": "a1b2c3d4",
  "ip": "192.168.1.100",
  "user": "root",
  "command": "uname -a",
  "response_len": 45,
  "source": "llm",
  "risk_score": 3
}
```

### 3. Uploaded Files
Files uploaded via SCP/SFTP are quarantined in `data/uploaded_files/<session_id>/`.
They are stripped of execution permissions but should still be handled with care.

## Analytics Tools

FauxSSH includes CLI tools to visualize the data.

### `tools/analytics/analyze.py`
The primary reporting tool with multiple modes.

**List Recent Sessions:**
```bash
python3 tools/analytics/analyze.py --sessions
```

**List Recent Commands:**
```bash
python3 tools/analytics/analyze.py --commands
```

**Review Specific Session (Replay):**
```bash
python3 tools/analytics/analyze.py --session-id <SESSION_ID>
```

**Filter by IP:**
```bash
python3 tools/analytics/analyze.py --ip <IP_ADDRESS>
```

**List Recent Commands:**
```bash
python3 tools/analytics/analyze.py --commands
```

**Privacy Mode (Mask IPs):**
```bash
python3 tools/analytics/analyze.py --sessions --anon
```

### `tools/analytics/fs_inspector.py`
Inspect, filter, and delete files uploaded by attackers.

**List all uploads (Tree View):**
```bash
python3 tools/analytics/fs_inspector.py --tree
```

**View file content:**
```bash
python3 tools/analytics/fs_inspector.py --ip <IP> --cat <PATH>
```

**Delete specific attacker files:**
```bash
python3 tools/analytics/fs_inspector.py --ip <IP> --file <PATH> --delete
```

### `tools/analytics/correlate_actors.py`
Find actors using the same credentials or SSH keys across different IPs.

```bash
python3 tools/analytics/correlate_actors.py
```
